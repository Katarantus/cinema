#  
CREATE TABLE IF NOT EXISTS `films` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `genre` varchar(20) NOT NULL,
  `times` TIME NOT NULL,
  `year_create` YEAR NOT NULL,
  `format` ENUM('2D','3D','4D'),
  PRIMARY KEY (`id`)
);

# 4 
INSERT INTO `films` (`name`,`genre`,`times`,`year_create`,`format`) VALUES
('Firebrand','thriller','02:01','2024','2D'),
('The Last Breath','horrors','01:36','2024','3D'),
('Dune: Part Two','fantasy','02:35','2024','3D'),
('The Ministry of Ungentlemanly Warfare','action movie','01:59','2024','3D');

#  
CREATE TABLE IF NOT EXISTS `sessions` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `film_id` varchar(50) NOT NULL,
  `date` DATE NOT NULL,
  `times` TIME NOT NULL,
  PRIMARY KEY (`id`)
);

# 
INSERT INTO `sessions` (`film_id`, `date`, `times`) VALUES
('3','2021-01-29','11:30'),
('3','2021-01-30','15:30'),
('3','2021-02-01','17:50'),
('1','2021-01-29','14:00'),
('1','2021-01-30','19:50'),
('1','2021-02-01','14:00'),
('1','2021-02-01','19:50'),
('4','2021-02-01','17:50'),
('4','2021-02-01','10:40'),
('3','2021-02-01','13:50'),
('1','2021-02-01','19:50'),
('2','2021-02-01','10:40'),
('2','2021-02-01','10:40'),
('2','2021-02-01','10:40'),
('2','2021-02-01','10:40'),
('2','2021-02-01','10:40');

#  
CREATE TABLE IF NOT EXISTS `tickets` (
  `id` INT(10) unsigned NOT NULL AUTO_INCREMENT,
  `sessions_id` INT(10) NOT NULL,
  `place` INT(20) NOT NULL,
  `row` INT(10) NOT NULL,
  `buy` ENUM('Y','N') NOT NULL,
  `res` ENUM('Y','N') NOT NULL,
  PRIMARY KEY (`id`)
);
#  
INSERT INTO `tickets` (`sessions_id`,`place`,`row`, `buy`, `res`) VALUES
('1','1','1','N','N'),
('1','2','1','N','N'),
('1','3','1','N','N'),
('1','4','1','N','N'),
('1','5','1','N','N'),
('1','6','1','N','N'),
('1','7','1','N','N'),
('1','8','1','N','N'),
('1','9','1','N','N'),
('1','10','1','N','N'),
('1','1','2','N','N'),
('1','2','2','N','N'),
('1','3','2','N','N'),
('1','4','2','N','N'),
('1','5','2','N','N'),
('1','6','2','N','N'),
('1','7','2','N','N'),
('1','8','2','N','N'),
('1','9','2','N','N'),
('1','10','2','N','N'),
('2','1','1','N','N'),
('2','2','1','N','N'),
('2','3','1','N','N'),
('2','4','1','N','N'),
('2','5','1','N','N'),
('2','6','1','N','N'),
('2','7','1','N','N'),
('2','8','1','N','N'),
('2','9','1','N','N'),
('2','10','1','N','N'),
('2','1','2','N','N'),
('2','2','2','N','N'),
('2','3','2','N','N'),
('2','4','2','N','N'),
('2','5','2','N','N'),
('2','6','2','N','N'),
('2','7','2','N','N'),
('2','8','2','N','N'),
('2','9','2','N','N'),
('2','10','2','N','N'),
('3','1','1','N','N'),
('3','2','1','N','N'),
('3','3','1','N','N'),
('3','4','1','N','N'),
('3','5','1','N','N'),
('3','6','1','N','N'),
('3','7','1','N','N'),
('3','8','1','N','N'),
('3','9','1','N','N'),
('3','10','1','N','N'),
('3','1','2','N','N'),
('3','2','2','N','N'),
('3','3','2','N','N'),
('3','4','2','N','N'),
('3','5','2','N','N'),
('3','6','2','N','N'),
('3','7','2','N','N'),
('3','8','2','N','N'),
('3','9','2','N','N'),
('3','10','2','N','N'),
('4','1','1','N','N'),
('4','2','1','N','N'),
('4','3','1','N','N'),
('4','4','1','N','N'),
('4','5','1','N','N'),
('4','6','1','N','N'),
('4','7','1','N','N'),
('4','8','1','N','N'),
('4','9','1','N','N'),
('4','10','1','N','N'),
('4','1','2','N','N'),
('4','2','2','N','N'),
('4','3','2','N','N'),
('4','4','2','N','N'),
('4','5','2','N','N'),
('4','6','2','N','N'),
('4','7','2','N','N'),
('4','8','2','N','N'),
('4','9','2','N','N'),
('4','10','2','N','N'),
('5','1','1','N','N'),
('5','2','1','N','N'),
('5','3','1','N','N'),
('5','4','1','N','N'),
('5','5','1','N','N'),
('5','6','1','N','N'),
('5','7','1','N','N'),
('5','8','1','N','N'),
('5','9','1','N','N'),
('5','10','1','N','N'),
('5','1','2','N','N'),
('5','2','2','N','N'),
('5','3','2','N','N'),
('5','4','2','N','N'),
('5','5','2','N','N'),
('5','6','2','N','N'),
('5','7','2','N','N'),
('5','8','2','N','N'),
('5','9','2','N','N'),
('5','10','2','N','N'),
('6','1','1','N','N'),
('6','2','1','N','N'),
('6','3','1','N','N'),
('6','4','1','N','N'),
('6','5','1','N','N'),
('6','6','1','N','N'),
('6','7','1','N','N'),
('6','8','1','N','N'),
('6','9','1','N','N'),
('6','10','1','N','N'),
('6','1','2','N','N'),
('6','2','2','N','N'),
('6','3','2','N','N'),
('6','4','2','N','N'),
('6','5','2','N','N'),
('6','6','2','N','N'),
('6','7','2','N','N'),
('6','8','2','N','N'),
('6','9','2','N','N'),
('6','10','2','N','N'),
('7','1','1','N','N'),
('7','2','1','N','N'),
('7','3','1','N','N'),
('7','4','1','N','N'),
('7','5','1','N','N'),
('7','6','1','N','N'),
('7','7','1','N','N'),
('7','8','1','N','N'),
('7','9','1','N','N'),
('7','10','1','N','N'),
('7','1','2','N','N'),
('7','2','2','N','N'),
('7','3','2','N','N'),
('7','4','2','N','N'),
('7','5','2','N','N'),
('7','6','2','N','N'),
('7','7','2','N','N'),
('7','8','2','N','N'),
('7','9','2','N','N'),
('7','10','2','N','N'),
('8','1','1','N','N'),
('8','2','1','N','N'),
('8','3','1','N','N'),
('8','4','1','N','N'),
('8','5','1','N','N'),
('8','6','1','N','N'),
('8','7','1','N','N'),
('8','8','1','N','N'),
('8','9','1','N','N'),
('8','10','1','N','N'),
('8','1','2','N','N'),
('8','2','2','N','N'),
('8','3','2','N','N'),
('8','4','2','N','N'),
('8','5','2','N','N'),
('8','6','2','N','N'),
('8','7','2','N','N'),
('8','8','2','N','N'),
('8','9','2','N','N'),
('8','10','2','N','N'),
('9','1','1','N','N'),
('9','2','1','N','N'),
('9','3','1','N','N'),
('9','4','1','N','N'),
('9','5','1','N','N'),
('9','6','1','N','N'),
('9','7','1','N','N'),
('9','8','1','N','N'),
('9','9','1','N','N'),
('9','10','1','N','N'),
('9','1','2','N','N'),
('9','2','2','N','N'),
('9','3','2','N','N'),
('9','4','2','N','N'),
('9','5','2','N','N'),
('9','6','2','N','N'),
('9','7','2','N','N'),
('9','8','2','N','N'),
('9','9','2','N','N'),
('9','10','2','N','N'),
('10','1','1','N','N'),
('10','2','1','N','N'),
('10','3','1','N','N'),
('10','4','1','N','N'),
('10','5','1','N','N'),
('10','6','1','N','N'),
('10','7','1','N','N'),
('10','8','1','N','N'),
('10','9','1','N','N'),
('10','10','1','N','N'),
('10','1','2','N','N'),
('10','2','2','N','N'),
('10','3','2','N','N'),
('10','4','2','N','N'),
('10','5','2','N','N'),
('10','6','2','N','N'),
('10','7','2','N','N'),
('10','8','2','N','N'),
('10','9','2','N','N'),
('10','10','2','N','N');
#   
CREATE TABLE IF NOT EXISTS `reservation` (
  `id` INT(10) unsigned NOT NULL AUTO_INCREMENT,
  `tickets_id` INT(10) NOT NULL,
  PRIMARY KEY (`id`)
);

#   
CREATE TABLE IF NOT EXISTS `bought` (
  `id` INT(10) unsigned NOT NULL AUTO_INCREMENT,
  `tickets_id` INT(10) NOT NULL,
  PRIMARY KEY (`id`)
);

# 

#    
CREATE VIEW `view_sessions_today` AS SELECT CONCAT(`f`.`name`,' - ', `s`.`times`) FROM `films` AS `f`, `sessions` AS `s` WHERE CURDATE()=`s`.`date` AND `s`.`film_id`=`f`.`id`;
SELECT  FROM `view_sessions_today`;

#    
CREATE VIEW `films_discription` AS SELECT CONCAT(`name`, ' - ' ,`genre`,', ',`times`,', ',`year_create`,', ',`format`) FROM `films`;
SELECT  FROM `films_discription`;

#  
#INSERT INTO `reservation` (`tickets_id`)
#SELECT `id` FROM `tickets`
#WHERE 'res' = 'Y';
#SELECT  FROM `create_reservation`;
#  
#INSERT INTO `bought` (`tickets_id`)
#SELECT `id` FROM `tickets`
#WHERE 'buy' = 'Y';

#  
CREATE VIEW `view_unemployed_tickets` AS SELECT CONCAT(`sessions_id`,' place',`place`,' row',`row`) FROM `tickets` WHERE `res` = 'N' OR `buy` = 'N';
SELECT  FROM `view_unemployed_tickets`;

#    
CREATE VIEW `view_unemployed_tickets` AS SELECT CONCAT(`sessions_id`,' place',`place`,' row',`row`, ' res',`res`, ' buy', `buy`) FROM `tickets` WHERE `res` = 'Y' OR `buy` = 'Y';
SELECT  FROM `view_unemployed_tickets`;

# 
	UPDATE `tickets`
        SET `buy` = 'Y'
        WHERE `id` = '1';
        INSERT INTO `bought` (`tickets_id`)
        SELECT `id` FROM `tickets`
        WHERE `buy` = 'Y';
# 
	UPDATE `tickets`
        SET `res` = 'Y'
        WHERE `id` = '1';
        INSERT INTO `bought` (`tickets_id`)
        SELECT `id` FROM `tickets`
        WHERE `res` = 'Y';
	

